# Pilsung Fighter Communication Protocol (PSFCP)

## Server-Client Communication

Server-Client communication is established using websockets, which may be configured for direct port-to-port communication or via proxy/reverse proxy (for encrypted communications) using the Apache webserver.

The default port for PSFCP is 3030.

Most communication is initiated by a client. Typically a client makes a request to the server to provide some service, and the server provides a response or an error in return.

One notable exception is server pings to gauge client connection strength. 

### Requests

- subject:
- action:
- from: &lt;cid&gt; | 0 *(Automatically supplied by the server)*
- ring: &lt;rnum&gt; *(Automatically supplied by the server)*
- *other parameters as needed*

If `<cid>` is 0, then the request originates from the server.

### Responses

    {
        "request": <request>
        "subject": bracket | contestant | division | match | ring | round,
        <subject>
    }

## Subjects

### Division

#### Division Create/Update

    "action" : "write",
    "division" : { <division parameters> }

#### Division Read

    "action" : "read",

#### Division Delete

    "action" : "delete",

#### Division Add Contestant

    "action" : "add_contestant",
    "contestant" : { <contestant parameters> }

Use case: Divisions are not generated by staging and/or an contestant shows up late to the ring and the tournament director permits the contestant to compete in the division.

#### Division Add Match

    "action" : "add_match",
    "round" : <round code>,
    "match" : { <match parameters> }

### Match

A minimal request template is shown below. Requests are based on the minimal template, with the listed *action* specified and additional parameters specified as needed.

**Minimal Request**

    {
        "subject": "match",
        "action": <action>
    }

#### Match Create/Update

    "action" : "write",
    "match" : { <match parameters> }

#### Match Read

    "action" : "read"

#### Match Score

    "action" : "score",
    "contestant" : chung | hong,
    "presentation" : -0.1 | 0.1,
    "technical" : 0.1 | 0.2 | 0.3,
    "deduction" : -0.1 | 0.1

#### Match Update Penalty Timer

    "action" : "update penalty timer",
    "match" : { "uuid" : <UUID> },
    "contestant" : "chung" | "hong",
    "timer" : { "action" : "start" | "pause" | "resume" | "reset" }
